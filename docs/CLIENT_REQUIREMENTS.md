# 클라이언트 요구사항 정리

> **직원용 SaaS** – 매장주·판매사·본사만 사용. 고객(일반 소비자) 가입·소셜 로그인 없음.  
> 고객관리(CRM)·대시보드·공지·재고·판매일보 관련 클라이언트 요청을 정리한 문서입니다.

---

## 0. 로그인·가입 정책 (직원용)

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| **매장주가 발급하는 매장키만** 필요 | **구현됨** | 매장주가 "판매사 초대·관리"에서 초대 코드 발급 → 판매사는 로그인 페이지 "판매사 가입" 탭에서 매장키 입력 후 가입 |
| **소셜 로그인 불필요** | **반영됨** | Google/네이버/카카오/Facebook 로그인 버튼 제거. 아이디·비밀번호 로그인 + 매장키(초대 코드) 가입만 사용 |

---

## 1. 핵심 기능 (4가지)

### 1.1 고객관리 – CRM

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| CRM 필요 | 고객 관리 페이지 있음, **내용은 준비 중** | 고객별 상담 이력, 유입 채널 통계 등 CRM 기능 구현 필요 |

**구현 방향 제안**

- 고객 목록: 판매일보·계약에서 쌓인 고객 자동 수집 또는 직접 등록
- 고객 상세: 상담/개통 이력 타임라인, 연락처, 메모
- 유입 경로·채널별 통계
- (선택) 예약·팔로업 알림

---

### 1.2 대시보드 – 요약(세일즈 활용)

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| 대시보드, 요약본으로 세일즈 활용 | **구현됨** | 오늘 개통 건수, 예상 마진, 빠른 작업(계약·판매일보) |

**보강 제안**

- 오늘 목표 vs 실적 (목표 설정 기능 추가)
- 기간별(주/월) 개통·마진 추이
- 매장/판매사별 간단 요약 (권한에 따라 노출)

---

### 1.3 공지

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| 공지 필요 | **구현됨** | 공지 목록·상세, 상단고정. 현재는 목업 데이터 |

**보강 제안**

- 실제 DB/API 연동 후 CRUD
- 작성자·대상(전체/매장별) 구분
- 첨부파일 (선택)

---

### 1.4 매장 재고현황

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| 매장별 재고 현황 | **미구현** | 신규 기능 |

**구현 방향 제안**

- 매장별 단말기(모델·색상·용량 등) 재고 수량
- 입고/출고(판매·반품) 기록
- 재고 부족 알림 또는 목표 재고량 대비 표시 (선택)

---

## 2. 판매일보 기능 상세

### 2.1 매장별 데이터 격리 (지점에서 다른 매장 비노출)

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| 개별 매장에서 볼 때 **해당 매장만** 표시 | **구현됨** | `shopId` 기준 필터, 지점(staff/tenant_admin)은 자기 `shopId`만 사용. 슈퍼어드민만 매장 선택 가능 |

- 유지: 지점 사용자는 매장 선택 드롭다운을 **노출하지 않고** 항상 본인 매장 데이터만 사용.

---

### 2.2 판매일보 문서 업로드

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| 판매일보 문서(엑셀) 업로드 | **구현됨** | 엑셀 업로드 → 파싱 → 해당 매장 일보에 반영 |

- 엑셀 컬럼 매핑 확장은 아래 “직접 입력/필드”와 맞추면 됨.

---

### 2.3 판매일보 직접 입력

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| 판매일보에 **직접 입력** 가능 | **미구현** | 폼 추가 필요 |

**구현 방향**

- “행 추가” 버튼으로 한 건씩 입력
- 필드: 판매사, 고객명, 연락처, 개통단말기, 통신사, 요금제, 판매일, 금액, 마진, 지원금 등 (아래 필드 목록과 동일하게)

---

### 2.4 마진 표시

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| 판매일보에 **마진** 표시 | **구현됨** | 목록·고객별 그룹 뷰에 마진 컬럼 있음 |

- 유지. 추가로 “일별/기간별 마진 합계” 등은 대시보드 보강 시 반영 가능.

---

### 2.5 지점용 필드 (필수 항목)

클라이언트 요청:  
**“판매사, 고객명, 연락처, 개통단말기, 통신사, 요금제”** 중심으로 단순화.

| 필드(표시명) | 현재 ReportEntry 필드 | 비고 |
|-------------|------------------------|------|
| 판매사 | 없음 | **추가** `salesPerson` (또는 staffId) |
| 고객명 | `name` | 유지 |
| 연락처 | `phone` | 유지 |
| 개통단말기 | `productName` | 유지 (또는 `deviceName`) |
| 통신사 | `existingCarrier` | 유지 (또는 `carrier`) |
| 요금제 | 없음 | **추가** `planName` |
| 판매일 | `saleDate` | 유지 |
| 금액 | `amount` | 유지 |
| 마진 | `margin` | 유지 |

- 엑셀 파싱·직접 입력 폼·목록 테이블에 위 필드 반영.

---

### 2.6 본사 정책단가 → 지점 즉시 반영

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| 본사에서 입력한 **정책단가**가 각 지점에 **바로 찍힘** | 정책은 `usePolicyStore`에 있음. 수정은 슈퍼어드민(정책/단가 관리)에서 가능 | 현재는 localStorage 단일 저장소라 “본사→지점” 동기화는 앱 내 역할 구분으로 충족. 백엔드 도입 시 본사가 정책 수정 시 지점 서버/클라이언트에 푸시하는 구조로 확장 가능 |

- **정책단가 수정 권한**: 슈퍼어드민만 가능 (현재 정책/단가 관리 메뉴와 동일).
- 추후: API + 실시간 반영(웹소켓/폴링) 시 “본사 입력 → 지점 즉시 반영” 명시 구현.

---

### 2.7 지원금 내역 (고객 지원 금액)

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| **내가 고객에게 얼마나 지원했는지**, 지원금 내역 표시 | **미구현** | 판매일보에 “지원금” 필드 없음 |

**구현 방향**

- `ReportEntry`에 `supportAmount`(지원금) 필드 추가.
- 판매일보 목록·상세·엑셀 업로드/다운로드·직접 입력에 지원금 포함.
- (선택) 기간별/고객별 지원금 합계를 대시보드나 간단 보고에 노출.

---

### 2.8 직원 급여 표시

| 요구 | 현재 상태 | 비고 |
|------|-----------|------|
| 판매일보에 **직원 급여**가 보여야 함 | **미구현** | 필드/화면 없음 |

**구현 방향 (선택지)**

- **A.** 판매일보 한 건에 “담당 직원 급여”(해당 건 기준 급여) 필드 추가  
  - 예: `employeeSalary` 또는 `commission`
- **B.** 별도 “급여 관리” 메뉴에서 직원별 급여를 관리하고, 판매일보에서는 “판매사(직원)”만 보여주고, 급여는 급여 화면에서만 조회
- **C.** 판매일보 목록 하단 또는 별도 블록에 “이 매장 / 이 기간 직원 급여 요약” 표시 (직원별 급여는 다른 저장소에서 가져오기)

클라이언트와 협의 후, “판매일보 화면에서 무엇을 보고 싶은지”(건별 급여 vs 기간/매장 요약)에 따라 A/B/C 결정.

---

## 3. 구현 우선순위 제안

| 순위 | 항목 | 구분 | 비고 |
|------|------|------|------|
| 1 | 판매일보: 해당 매장만 노출 | 확인/유지 | 이미 구현됨 |
| 2 | 판매일보: 직접 입력 | 신규 | 지점에서 엑셀 없이 입력 |
| 3 | 판매일보: 판매사·요금제·지원금 필드 | 확장 | ReportEntry + 엑셀 매핑 + UI |
| 4 | 판매일보: 직원 급여 표시 | 신규 | 방식(A/B/C) 결정 후 구현 |
| 5 | 대시보드: 목표·기간별 요약 보강 | 보강 | 세일즈 활용도 상승 |
| 6 | 고객관리: CRM 기능 | 신규 | 고객 목록·이력·통계 |
| 7 | 매장 재고현황 | 신규 | 재고·입출고 |
| 8 | 공지: DB 연동 | 보강 | 목업 → 실제 데이터 |

---

## 4. 데이터 구조 변경 요약 (판매일보)

- **ReportEntry** 확장 필드 제안:
  - `salesPerson?: string`   // 판매사(담당자) 이름 또는 ID
  - `planName?: string`     // 요금제
  - `supportAmount?: number` // 고객 지원금
  - `employeeSalary?: number` 또는 `commission?: number` (직원 급여 반영 시)

- **엑셀 매핑** (`excel-report.ts` HEADER_MAP):  
  위 필드에 대응하는 한글/영문 헤더 추가 (예: 판매사, 요금제, 지원금, 급여 등).

이 문서는 클라이언트 요청을 개발용으로 정리한 것이며, 실제 스프린트는 우선순위와 리소스에 따라 조정하면 됩니다.
